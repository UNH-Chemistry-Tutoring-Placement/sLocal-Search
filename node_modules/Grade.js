/**
 * Created by jeep on 10/28/15.
 */
module.exports.grade = Grade;
module.exports.gradeWith = GradeWith;
module.exports.gradeWithout = GradeWithout;

function Grade(data, timeslot, studentsInTimeslot){
    var belowMin = data.objective.penalties.belowMin
    var aboveMax = data.objective.penalties.aboveMax
    var possChoice = data.objective.penalties.possibleChoice
    var impossChoice = 10
    var grade = 0
    if (timeslot.length < data.objective.min) grade = grade + belowMin
    if (timeslot.length > data.objective.max) grade = grade + aboveMax
    for (i = 0; i < studentsInTimeslot.length; i++) {
        var stud = studentsInTimeslot[i]
        for (j = 0; j < stud.goodTimes; i++) {
            var str = stud.goodTimes[j]
            if (str.localeCompare(timeslot) === 0) {
                break;
            }
        }
        for (j = 0; j < stud.possibleTimes; j++) {
            var str = stud.possibleTimes[j]
            if (str.localeCompare(timeslot) === 0) {
                grade = grade + possChoice;
                break;
            }
        }
        grade = grade + impossChoice
    }
    return grade;
}

function GradeWithout(data, timeslot, studentsInTimeslot, removeStudent) {
    
    var studentIndex = studentsInTimeslot.indexOf(removeStudent);
    
    //remove the student
    studentsInTimeslot.splice(studentIndex, 1);
    
    //grade it
    var grade = Grade(data, timeslot, studentsInTimeslot);
    
    //add back the student
    studentsInTimeslot.splice(studentIndex, 0, removeStudent);
    
    return grade;
}

function GradeWith(data, timeslot, studentsInTimeslot, extraStudent) {
    
    //add the student to the end
    studentsInTimeslot.push(extraStudent);
    
    //grade
    var grade = Grade(data, timeslot, studentsInTimeslot);
    
    //remove student
    studentsInTimeslot.pop();
    
    return grade;
    
}


