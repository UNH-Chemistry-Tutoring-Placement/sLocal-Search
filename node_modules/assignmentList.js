/**
 * Used to pass list of students to SWO.js
 */
module.exports = studentList

var data = require('FileData').get();
//var assignment = data.assignment
function studentList(){
    var studentsArr = []
    var assignment = data.assignment
    for(s in data.student.students){
        var student = data.student.students[s]
        student.assignment = getTime(student, assignment)
        student.satisfaction = rateAssignment(student)
        studentsArr.push(student)
    }

    studentsArr.sort((function(a,b){
        return a.satisfaction - b.satisfaction;
    }))

    return studentsArr
}

function rateAssignment(student){
    for(i in student.goodTimes) if(stringStartsWith(student.assignment, student.goodTimes[i])) return 0
    for(i in student.possibleTimes) if(stringStartsWith(student.assignment, student.possibleTimes[i])) return 1
    return 2;
}

function getTime(student, assignment){
    for(t in assignment){
       // console.log("in")
        for(s in assignment[t]){
            //console.log("Comparing: " + assignment[t][s] + " to: " + student.email)
            if(assignment[t][s] == student.email){
              //  console.log("hit")
                return t
            }
        }
    }
}

function stringStartsWith (string, prefix) {
    return string.slice(0, prefix.length) == prefix;
}