module.exports = AWS;

var swap = require('Swap'),
    data = require('FileData').get(),
    grader = require('Grade');


function AWS(){
    var results = []
//-----------------------Want to do this in a for loop but having issues-----------------------------------------------
    var test1 = swap()
    var test2 = swap()
    var test3 = swap()
    var test4 = swap()
    var test5 = swap()
    var test6 = swap()
    var test7 = swap()
    var test8 = swap()
    var test9 = swap()
    var test10 = swap()

    results.push(test1)
    results.push(test2)
    results.push(test3)
    results.push(test4)
    results.push(test5)
    results.push(test6)
    results.push(test7)
    results.push(test8)
    results.push(test9)
    results.push(test10)
//---------------------------------------------------------------------------------------------------------------------

    for(var i=0;i<10;i++) {
        results = top5(results)
        var result = {}
        var assignment = {}
        for (var studentEmail in data.student.students) {
            var individual = assignIndividual(studentEmail, results)
            if (!(individual.student === undefined)) {
                if (assignment[individual.time] === undefined) {
                    assignment[individual.time] = []
                    assignment[individual.time].push(individual.student)
                } else {
                    assignment[individual.time].push(individual.student)
                }
            }
        }
        result.grade = grader.gradeTotal(assignment);
        result.assignments = assignment;
        results.push(result);
    }
    results = top5(results)
    console.log(results[0])
}

//returns top five assignments by grade
function top5(results){
    results.sort(function(a,b){return a.grade- b.grade});
    return results.slice(0,5);
}

//take student and pick one of their five assigned times -Think it might be missing some students-
function assignIndividual(student,bestSoFar){
    var rand = randNumber(0,bestSoFar.length);
    var ret = {}
    for(var time in bestSoFar[rand].assignments){
        for(var email in bestSoFar[rand].assignments[time]){
            if(bestSoFar[rand].assignments[time][email] == student){
                ret.student = student
                ret.time = time
                break
            }
        }
    }
    return ret
}

function randNumber(min,max){
    return Math.floor(Math.random() * (max-min) + min);
}